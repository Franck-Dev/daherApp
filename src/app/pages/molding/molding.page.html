<app-shared-user-header [page]="pageTitle"></app-shared-user-header>
<ion-content>
    <ion-toolbar>
        <ion-buttons slot="start" collapse="true">
            <ion-button #scanButton fill=solid size=default (click)="switchScanState()">
                <!-- <ion-icon slot="start" name="scan-outline"></ion-icon> -->
                {{scanButtonText}}
            </ion-button>
            <ion-input #scanInput type="text" placeholder="Id du kit" (change)="scanInputAction()" (focusout)="inputOnBlur()" (focusin)="inputOnFocus()"></ion-input>
            <ion-button (click)="associateToolClick()" fill=outline size=default>
                <ion-icon slot="start" name="link-outline"></ion-icon>
                Associer un outillage
            </ion-button>
        </ion-buttons>
    </ion-toolbar>


    <ion-list *ngIf="molding?.kits">
        <ion-item>
            <ion-label>Référence Sap</ion-label>
            <ion-label>Désignation</ion-label>
            <ion-label>Péremption à -18°C</ion-label>
            <ion-label>A draper avant le</ion-label>
            <ion-label>A cuire avant le</ion-label>
        </ion-item>
        <ion-item *ngFor="let kit of molding.kits; let index = index">
            <ion-label>{{kit.referenceSAP}} <span *ngIf="kit === molding.matDrap">(Drap)</span><span *ngIf="kit === molding.matPolym">(Pol)</span></ion-label>
            <ion-label>{{kit.designationSAP}}</ion-label>
            <ion-label [color]="kitService.isPerim(kit.peremptionMoins18, molding.moldingDay) ? 'danger' : 'dark'">{{kit.peremptionMoins18 | date: "dd/MM/yyyy à HH:mm"}}</ion-label>
            <ion-label [color]="kitService.isPerim(kit.aDrapAv, molding.moldingDay) ? 'danger' : 'dark'">{{kit.aDrapAv | date: "dd/MM/yyyy à HH:mm"}}</ion-label>
            <ion-label [color]="kitService.isPerim(kit.aCuirAv, molding.moldingDay) ? 'danger' : 'dark'">{{kit.aCuirAv | date: "dd/MM/yyyy à HH:mm"}}</ion-label>
            <ion-button (click)="removeKit(index)">
                <ion-icon slot="icon-only" name="trash-outline"></ion-icon>
            </ion-button>
        </ion-item>
    </ion-list>
</ion-content>
<ion-footer>
    <ion-toolbar>
        <ion-item>
            <ion-title>Récapitulatif</ion-title>
            <ion-label>Outillage : {{molding?.moldingTool?.sapToolNumber}}</ion-label>
            <ion-label>A draper avant le : {{molding?.aDraperAv | date: "dd/MM/yyyy à HH:mm"}}</ion-label>
            <ion-label>A cuire avant le : {{molding?.aCuireAv | date: "dd/MM/yyyy à HH:mm"}}</ion-label>

        </ion-item>
        <ion-button (click)="saveMoldingClick()" expand="block" fill="clear" shape="round">
            SAUVEGARDER MOULAGE
        </ion-button>
        <ion-button (click)="printMoldingClick()" expand="block" fill="clear" shape="round">
            IMPRIMER
        </ion-button>
    </ion-toolbar>
</ion-footer>