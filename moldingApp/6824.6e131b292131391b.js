"use strict";(self.webpackChunkapp=self.webpackChunkapp||[]).push([[6824,6188],{3580:(p,h,o)=>{o.d(h,{C:()=>A});var g=o(4762),s=o(8260),l=o(3668),m=o(3521),n=o(6188),P=o(2048),u=o(6607);let A=(()=>{class r{constructor(e,t,i,v){this.requestService=e,this.toolService=t,this.userService=i,this.authService=v}getType(e){return"string"==typeof e?e:e.controle?"controle":e.maintenance?"maintenance":void 0}createToolRequest(e){return this.requestService.createPostRequest(s.N.toolApi+"demandes",e)}createControlRequest(e){var t;const i={id:null!==(t=e.id)&&void 0!==t?t:null,outillage:e.outillage?this.toolService.getIri(e.outillage):"",dateBesoin:e.dateBesoin,userCreat:this.userService.getIri(this.authService.authUser),refPlan:e.refPlan,indPlan:e.indPlan,cheminCAO:e.cheminCAO,description:e.description,detailsControle:e.detailsControle,tolerances:e.tolerances,dispoOut:e.dispoOut,ligneBudgetaire:e.ligneBudgetaire,typeRapport:e.typeRapport};return this.requestService.createPostRequest(s.N.toolApi+"controles",i)}createAllMaintenaceItems(e){const t=[];return new Promise((i,v)=>{e.itemActionCorrective.forEach(c=>{this.requestService.createPostRequest(s.N.toolApi+"maintenance_items",c).then(d=>{t.push(`/api/maintenance_items/${d.id}`),console.log(t.length,e.itemActionCorrective.length),t.length===e.itemActionCorrective.length&&i(t)})})})}createMaintenanceRequest(e){return new Promise((t,i)=>{this.createAllMaintenaceItems(e).then(v=>{var c;console.log(v);const d={id:null!==(c=e.id)&&void 0!==c?c:null,outillage:e.outillage?this.toolService.getIri(e.outillage):"",dateBesoin:e.dateBesoin,userCreat:this.userService.getIri(this.authService.authUser),rep:e.rep,itemActionCorrective:v};console.log(d),this.requestService.createPostRequest(s.N.toolApi+"maintenances",d).then(_=>{t(_)})})})}updateRequest(e){const t={statut:e.statut,createdAt:e.createdAt,id:e.id};return this.requestService.createPutRequest(s.N.toolApi+"demandes/"+t.id,t)}updateControlRequest(e){var t;const i={id:null!==(t=e.controle.id)&&void 0!==t?t:null,outillage:e.controle.outillage?this.toolService.getIri(e.controle.outillage):"",dateBesoin:e.dateBesoin,userCreat:this.userService.getIri(e.controle.demandeur),refPlan:e.controle.refPlan,indPlan:e.controle.indPlan,cheminCAO:e.controle.cheminCAO,description:e.controle.description,detailsControle:e.controle.detailsControle,tolerances:e.controle.tolerances,dispoOut:e.controle.dispoOut,ligneBudgetaire:e.controle.ligneBudgetaire,interventionDate:e.controle.interventionDate,moyenMesure:e.controle.moyenMesure,infosComplementaire:e.controle.infosComplementaire,visaControleur:e.controle.visaControleur,typeRapport:e.controle.typeRapport};return console.log(i),this.requestService.createPutRequest(s.N.toolApi+"controles/"+i.id,i)}updateMaintenanceItems(e){return(0,g.mG)(this,void 0,void 0,function*(){const t=e.map(i=>i.id?this.requestService.createPutRequest(s.N.toolApi+"maintenance_items/"+i.id,i):this.requestService.createPostRequest(s.N.toolApi+"maintenance_items",i));return Promise.all(t)})}updateMainteanceRequest(e){return new Promise((t,i)=>{this.updateMaintenanceItems(e.maintenance.itemActionCorrective).then(v=>{var c;e.maintenance.itemActionCorrective=v,console.log(e.maintenance.itemActionCorrective);const d=e.maintenance.itemActionCorrective.map(f=>"/api/maintenance_items/"+f.id),_={id:null!==(c=e.maintenance.id)&&void 0!==c?c:null,outillage:e.maintenance.outillage?this.toolService.getIri(e.maintenance.outillage):"",dateBesoin:e.dateBesoin,userCreat:this.userService.getIri(e.maintenance.userCreat),itemActionCorrective:d};console.log(_),t(this.requestService.createPutRequest(s.N.toolApi+"maintenances/"+_.id,_))})})}getToolRequest(e){return this.requestService.createGetRequest(s.N.toolApi+"demandes/"+e)}getToolRequests(){return this.requestService.createGetRequest(s.N.toolApi+"demandes")}getControl(e){return this.requestService.createGetRequest(s.N.toolApi+"controles/"+e)}getMaintenance(e){return this.requestService.createGetRequest(s.N.toolApi+"maintenances/"+e)}}return r.\u0275fac=function(e){return new(e||r)(l.LFG(m.s),l.LFG(n.o),l.LFG(P.f),l.LFG(u.e))},r.\u0275prov=l.Yz7({token:r,factory:r.\u0275fac,providedIn:"root"}),r})()},6188:(p,h,o)=>{o.d(h,{o:()=>P});var g=o(4522),s=o(8260),l=o(3668),m=o(3521),n=o(5243);let P=(()=>{class u{constructor(r,a,e){this.http=r,this.requestService=a,this.alertService=e}getToolByInput(r){return new Promise((a,e)=>{switch(r.length){case 5:this.getToolByToolNumber(r).then(t=>{a(t)},t=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",t),e()}).catch(t=>{console.error(t)});break;case 7:break;case 8:r.startsWith("OT")&&this.getToolByToolNumber(r.substring(r.length-5)).then(t=>{a(t)},t=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",t),e()}).catch(t=>{console.error(t)});break;default:this.getToolByIdentification(r).then(t=>{a(t)},t=>{this.alertService.simpleAlert("Erreur","Le serveur outillage \xe0 renvoy\xe9 une erreur :",t),e()}).catch(t=>{console.error(t)})}})}getToolById(r){return this.requestService.createGetRequest(`${s.N.toolApi}tools/${r}`)}getToolByToolNumber(r){return new Promise((a,e)=>{this.requestService.createGetRequest(`${s.N.toolApi}tools?sapToolNumber=${r}`).then(t=>{1===t.length?a(t[0]):e(t.length>1?"Il y a plus d'un outillage correspondant en base de donn\xe9e":"aucun outillage trouv\xe9")},t=>{console.log(t),e("Pas de r\xe9ponse du serveur")})})}getToolByIdentification(r){return new Promise((a,e)=>{this.requestService.createGetRequest(`${s.N.toolApi}tools?identification=${r}`).then(t=>{1===t.length?a(t[0]):e(t.length>1?"Il y a plus d'un outillage correspondant en base de donn\xe9e":"aucun outillage trouv\xe9")},t=>{console.log(t),e("Pas de r\xe9ponse du serveur")})})}getAllTools(){return new Promise((r,a)=>{const e=(new g.WM).append("content-type","application/json");this.http.get(`${s.N.apiServer}molding_tools`,{headers:e}).subscribe(t=>{r(t)},t=>{console.log(t),a()})})}getIri(r){return`/api/tools/${r.id}`}createTool(r){const a=r;return a.sapToolNumber=parseInt(r.sapToolNumber.substring(2),10),this.requestService.createPostRequest(s.N.toolApi+"tools",a)}}return u.\u0275fac=function(r){return new(r||u)(l.LFG(g.eN),l.LFG(m.s),l.LFG(n.c))},u.\u0275prov=l.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},2048:(p,h,o)=>{o.d(h,{f:()=>P});var g=o(8260),s=o(3668),l=o(4522),m=o(3521);let P=(()=>{class u{constructor(r,a){this.http=r,this.requestService=a}getUserById(r){return this.requestService.createGetRequest(g.N.usineApi+`users/${r}`)}getUsers(r){return this.requestService.createGetRequest(g.N.usineApi+"users")}registerUser(r){return this.requestService.createPostRequest(g.N.usineApi+"users",r)}getIri(r){return"string"==typeof r?r:`/api/users/${r.id}`}getGroups(){return this.requestService.createGetRequest(g.N.usineApi+"groupe_affectations")}createGroup(r){return this.requestService.createPostRequest(g.N.usineApi+"groupe_affectations",r)}}return u.\u0275fac=function(r){return new(r||u)(s.LFG(l.eN),s.LFG(m.s))},u.\u0275prov=s.Yz7({token:u,factory:u.\u0275fac,providedIn:"root"}),u})()},6824:(p,h,o)=>{o.r(h),o.d(h,{ToolListPageModule:()=>t});var g=o(6019),s=o(9133),l=o(1704),m=o(3935),n=o(3668),P=o(3580),u=o(5243);function A(i,v){1&i&&(n.TgZ(0,"ion-row",4),n.TgZ(1,"ion-col",2),n._uU(2,"Test"),n.qZA(),n.TgZ(3,"ion-col",2),n._uU(4,"Test"),n.qZA(),n.qZA())}const a=[{path:"",component:(()=>{class i{constructor(c,d){this.toolRequestService=c,this.alertControleService=d}ngOnInit(){this.updateToolList()}updateToolList(){this.toolRequestService.getToolRequests().then(c=>{this.requestList=c}).catch(c=>{this.alertControleService.simpleAlert("Erreur","Mise \xe0 jour de la liste","La liste des requ\xeates ne s'est pas mise \xe0 jour correctement")})}}return i.\u0275fac=function(c){return new(c||i)(n.Y36(P.C),n.Y36(u.c))},i.\u0275cmp=n.Xpm({type:i,selectors:[["app-tool-list"]],decls:12,vars:1,consts:[["fixed",""],[1,"header-row"],["size","6"],["class","request-row",4,"ngFor","ngForOf"],[1,"request-row"]],template:function(c,d){1&c&&(n.TgZ(0,"ion-header"),n.TgZ(1,"ion-toolbar"),n.TgZ(2,"ion-title"),n._uU(3,"toolList"),n.qZA(),n.qZA(),n.qZA(),n.TgZ(4,"ion-content"),n.TgZ(5,"ion-grid",0),n.TgZ(6,"ion-row",1),n.TgZ(7,"ion-col",2),n._uU(8,"header test"),n.qZA(),n.TgZ(9,"ion-col",2),n._uU(10,"header test"),n.qZA(),n.qZA(),n.YNc(11,A,5,0,"ion-row",3),n.qZA(),n.qZA()),2&c&&(n.xp6(11),n.Q6J("ngForOf",d.requestList))},directives:[l.Gu,l.sr,l.wd,l.W2,l.jY,l.Nd,l.wI,g.sg],styles:[""]}),i})()}];let e=(()=>{class i{}return i.\u0275fac=function(c){return new(c||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[[m.Bz.forChild(a)],m.Bz]}),i})(),t=(()=>{class i{}return i.\u0275fac=function(c){return new(c||i)},i.\u0275mod=n.oAB({type:i}),i.\u0275inj=n.cJS({imports:[[g.ez,s.u5,l.Pc,e]]}),i})()}}]);